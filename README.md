# MSGraph-Client

本程序真实维护人,主要人员:Micraow

此项目(MSGraph-Client)为原 OMM(O365-Mail-Manager)项目

用 Python 编写的程序，与 O365 连接并查阅邮件，查看日历等。我们的梦想是尽可能多的集成 API。

**欢迎 Pull requests 和 Issues!**

# 注意

我将通过微软官方的 API 来连接。
尚在开发初期，不建议日常使用，但是希望大家帮助我们。

## 关于 office 365 账户

事实上微软个人账号也能登陆，但
有一位朋友跟我讲说他需要获取 office E5 订阅
那么我就在这里讲一下大致的步骤。

1. 访问微软的开发者网站 https://developer.microsoft.com/zh-cn/office

2. 按下"立即加入"，或"了解更多信息"，接下来你需要登录你注册的免费的微软账号。
   ![网站](https://share.pengbo.workers.dev/1595596248544.jpg)

3. 然后它会要你填些信息，随便填一填就好了。

4. 然后它会提示你没有订阅，按左边的加号新建一个，这过程因为要通过谷歌的验证码进行验证，所以需要科学上网，准备好工具。

5.然后你添加完之后就能拿到一个有 25 位用户许可证的 E5 订阅，包含了全套的 office 套件，可用来正版激活软件，就不用熊那些么盗版的激活工具了，只要登录你的账号就可以激活办公软件了，不止支持软件的激活，这个订阅还包括了每个用户都有 5 TB 的云存储空间，还有你可以给他们分配邮箱。我的做法是给我的朋友们分配了这些邮箱，然后我便可以与他们联系。
[Office 网页版](https://office.com)
[管理员网站](https://admin.microsoft.com)
如果想要正常使用所有功能，需要在管理员网站中为你的主账户，就是默认生成的那个账户，也就是管理员账户分配一个许可证(E5)
此时你所有的邮箱后缀都为.onmicrosoft.com 如果你想要自定义后缀的话，可以绑定自定义域名，当然这些都是后话了，请自行百度。

需要注意的是，这个订阅是会过期的！如果 90 天内不进行开发活动(其实也有自动续订的方法)，微软就会删除你的订阅，这里推荐一个自动续订的方法
https://blog.curlc.com/archives/687.html
如果你觉得我讲的不够详细。那么你可以看一看这篇文章。
https://blog.curlc.com/archives/599.html
提醒:onedrive 默认的存储容量为 1 TB，需要将他们手动改为 5 TB，当然，1TB=1024 GB，相当于百度网盘的容量。你如果直连下载 onedrive 的文件的话，速度可能只比百度云快一点点，虽然微软没有对其进行限速，因为 onedrive 的服务器在国外，你可以搭建 oneindex(如果你使用的是自己的应用 ID 和机密，还可以提高续订的概率，因为据说微软时看 API 的调用量判断你的开发是否活跃。使用本程序也可以调用 API，虽然调用的是我的[偷笑]但是你可以换成你的，具体怎么换？我过一段时间回写下来。) 或其他的索引，或者一些在线的工具获取下载直链，然后通过 idm 多线程下载速度很快。
具体如何更改 onedrive 的容量，请看这篇文章。
https://blog.curlc.com/archives/66.html

## 优点

1. 简洁，体积小

## 使用场景

1. 大陆 O365 用户
   由于 GFW 的封锁，访问 O365 网页版服务时，加载 js，脚本，页面等会用很长时间，使用本程序就简化了这些，提高效率。
2. 轻度用户
   不经常看邮箱，日历，只偶尔看一下，不想要下载微软那么大的软件。
3. 即用即退的用户
   本程序登录简单，注销也简单。将...token.txt 删去即可。
4. 极客，发烧友。
5. Python 爱好者，学者，小白
   并不是很难，可以做代码示例学习。

## TO-DO

- ~~获取令牌~~
- ~~刷新令牌~~
- 读取邮件

## 更新日志

### 2020-8-18

从主分支分离。

### 2020-8-21

从原有的库中分离。
